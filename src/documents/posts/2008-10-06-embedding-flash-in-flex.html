---
layout: "home"
title: "Embedding Flash in Flex"
created: 1223303237
---
<p><strong>Embedding Flash in Flex</strong></p><p>At first I thought it has to be an easy task since Flash and Flex has the same father (Adobe). Well, actually it's a real pain because the results you get depends on the flash version you are trying to embed into Flex. You might have trouble aligning it and in the worst case you'll get an error.</p> <p>My first attempt was using SWFLoader component, it has everything you need for embedding Flash you can even send parameters along with the URL, for example:</p> <p><em>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br /> &lt;mx:Application<br /> &nbsp;&nbsp;&nbsp; xmlns:mx=&quot;http://www.adobe.com/2006/mxml&quot;<br /> &nbsp;&nbsp;&nbsp; layout=&quot;absolute&quot;&gt;<br /> <br /> &nbsp;&nbsp;&nbsp; &lt;mx:SWFLoader id=&quot;movieClip&quot; scaleContent=&quot;true&quot; x=&quot;0&quot; y=&quot;0&quot; source=&quot;@Embed('/assets/demo2.swf')&quot; width=&quot;100%&quot; height=&quot;100%&quot; /&gt;<br /> &lt;/mx:Application&gt;</em></p><p>In the above code relative URL can be used instead of the @Embed.</p><p>The problem with SWFLoader that it has a rough offset even if you are wrapping it with Canvas or a Box. SWFLoader results was not so good so I have decided to go deeper and use Action Script - maybe if I'll work with the&nbsp; bits and bytes I could bend the rules a bit.</p><p>I have search google and most of the code didn't work. The most common mistake was to add the loader to a MovieClip and then play it. In case you'll do that the swf will be displayed but it will not be set into the layout properly. Look at the example below, adding the loader as a child will load and play the swf as expected</p><p>Anothe issue is that older versions will not cast the loader.content (AVM1Movie) to a MovieClip component that is not so convenient if you want to use the MovieClip's API.</p><p>If you need to embed flash into flex, test it first as see if it works for you.</p><p><strong>as_embed_flash.mxml</strong></p><p><em>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br />&lt;mx:Application<br />&nbsp;&nbsp;&nbsp; xmlns:mx=&quot;http://www.adobe.com/2006/mxml&quot;<br />&nbsp;&nbsp;&nbsp; layout=&quot;absolute&quot;<br />&nbsp;&nbsp;&nbsp; creationComplete=&quot;complete()&quot;&gt;<br /><br />&nbsp;&nbsp;&nbsp; &lt;mx:Script&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;![CDATA[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; import mx.core.UIComponent;<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private var sprite:FlashSprite;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public function complete() : void {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sprite = new FlashSprite();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sprite.addEventListener(&quot;testListener&quot;, onSpriteComplete);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sprite.load();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private function onSpriteComplete(event:Event):void {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var component:UIComponent = new UIComponent();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; component.percentWidth = 100;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; component.percentHeight = 100;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; component.addChild(sprite);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; main_view.addChild(component);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var loader:Loader = sprite.getLoader();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; swfVer.text = &quot;SWF Version: &quot; + loader.contentLoaderInfo.swfVersion;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; asVer.text = &quot;Action Script Version: &quot; + loader.contentLoaderInfo.actionScriptVersion;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mcSupported.text = &quot;Is MovieClip Supported? &quot; + getMovieClip();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.setLoaderDimensions(main_view.width, main_view.height);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; main_view.visible = true;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /* Here you can do some custom manipulation if needed.*/<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; override protected function updateDisplayList(unscaledWidth:Number,<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unscaledHeight:Number):void {<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; super.updateDisplayList(unscaledWidth, unscaledHeight);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this.setLoaderDimensions(unscaledWidth, unscaledHeight);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private function setLoaderDimensions(aWidth:Number, aHeight:Number):void {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var loader:Loader = this.getLoader();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (loader != null) {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; loader.width = aWidth;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; loader.height = aHeight;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private function getLoader():Loader {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (main_view.getChildren().length &gt; 0 ) {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var comp:UIComponent = UIComponent(main_view.getChildAt(0));<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var flashSprite:FlashSprite = FlashSprite(comp.getChildAt(0));<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (flashSprite.getLoader() != null) {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var loader:Loader = flashSprite.getLoader();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (loader != null) {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return loader;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return null;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private function getMovie():AVM1Movie {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var loader:Loader = getLoader();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (loader != null) {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var movie:AVM1Movie =&nbsp; loader.content as AVM1Movie;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return movie;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return null;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private function getMovieClip():MovieClip {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var loader:Loader = getLoader();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (loader != null) {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var movie:MovieClip =&nbsp; loader.content as MovieClip;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return movie;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return null;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]]&gt;<br />&nbsp;&nbsp;&nbsp; &lt;/mx:Script&gt;<br /><br />&nbsp;&nbsp;&nbsp; &lt;mx:Box id=&quot;main_view&quot; width=&quot;100%&quot; height=&quot;100%&quot; visible=&quot;false&quot;/&gt;<br /><br />&nbsp;&nbsp;&nbsp; &lt;mx:Label x=&quot;10&quot; y=&quot;10&quot; id=&quot;swfVer&quot; text=&quot;SWF Version: &quot;/&gt;<br /><br />&nbsp;&nbsp;&nbsp; &lt;mx:Label x=&quot;10&quot; y=&quot;40&quot; id=&quot;asVer&quot; text=&quot;Action Script Version: &quot;/&gt;<br /><br />&nbsp;&nbsp;&nbsp; &lt;mx:Label x=&quot;10&quot; y=&quot;70&quot; id=&quot;mcSupported&quot; text=&quot;Is MovieClip Supported? &quot;/&gt;<br />&lt;/mx:Application&gt;</em></p><p><strong>FlashSprite.as</strong></p><p><em>package {<br />&nbsp;&nbsp;&nbsp; import flash.display.Loader;<br />&nbsp;&nbsp;&nbsp; import flash.display.MovieClip;<br />&nbsp;&nbsp;&nbsp; import flash.display.Sprite;<br />&nbsp;&nbsp;&nbsp; import flash.events.Event;<br />&nbsp;&nbsp;&nbsp; import flash.net.URLRequest;<br />&nbsp;&nbsp;&nbsp; import flash.system.ApplicationDomain;<br />&nbsp;&nbsp;&nbsp; import flash.system.LoaderContext;<br /><br />&nbsp;&nbsp;&nbsp; import mx.events.FlexEvent;<br /><br />&nbsp;&nbsp;&nbsp; [Event(name=&quot;testListener&quot;, type=&quot;mx.events.FlexEvent&quot;)]<br /><br />&nbsp;&nbsp;&nbsp; public class FlashSprite extends Sprite {<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private var panorama:MovieClip;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private var loader:Loader = new Loader();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public function FlashSprite() {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public function load():void {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var context:LoaderContext = new LoaderContext();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; context.applicationDomain = ApplicationDomain.currentDomain;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; loader.contentLoaderInfo.addEventListener(Event.COMPLETE, loadComplete);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; loader.contentLoaderInfo.addEventListener(Event.UNLOAD, closeAllStreams);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loader.load(new URLRequest(&quot;../src/assets/demo2.swf&quot;), context);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public function unload():void {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; loader.unload();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public function getLoader():Loader {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return loader;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // -- listeners<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private function loadComplete(e:Event):void {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this.addChild(loader);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.dispatchEvent(new FlexEvent(&quot;testListener&quot;));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private function closeAllStreams (e:Event):void {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, onRemoveComplete);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, onRemoveUnload);<br />&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this.removeChild(loader);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private function onRemoveComplete(e:Event):void {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // --<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private function onRemoveUnload(e:Event):void {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // --<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; }<br />}</em></p>
